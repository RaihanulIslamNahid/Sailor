!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).TweakpaneMediaPlugin={})}(this,(function(e){"use strict";const t="tp";function i(e){return(i,n)=>[t,"-",e,"v",i?`_${i}`:"",n?`-${n}`:""].join("")}function n(e){return t=>i=>{if(!t&&void 0===i)return{succeeded:!1,value:void 0};if(t&&void 0===i)return{succeeded:!0,value:void 0};const n=e(i);return void 0!==n?{succeeded:!0,value:n}:{succeeded:!1,value:void 0}}}function s(e){return{custom:t=>n(t)(e),boolean:n((e=>"boolean"==typeof e?e:void 0))(e),number:n((e=>"number"==typeof e?e:void 0))(e),string:n((e=>"string"==typeof e?e:void 0))(e),function:n((e=>"function"==typeof e?e:void 0))(e),constant:t=>n((e=>e===t?t:void 0))(e),raw:n((e=>e))(e),object:t=>n((e=>{var i;if(null!==(i=e)&&"object"==typeof i)return function(e,t){return Object.keys(t).reduce(((i,n)=>{if(void 0===i)return;const s=(0,t[n])(e[n]);return s.succeeded?Object.assign(Object.assign({},i),{[n]:s.value}):void 0}),{})}(e,t)}))(e),array:t=>n((e=>{var i;if(Array.isArray(e))return i=t,e.reduce(((e,t)=>{if(void 0===e)return;const n=i(t);return n.succeeded&&void 0!==n.value?[...e,n.value]:void 0}),[])}))(e)}}const a={optional:s(!0),required:s(!1)};function r(e,t){const i=a.required.object(t)(e);return i.succeeded?i.value:void 0}function o(e){return t=>t.toFixed(Math.max(Math.min(e,20),0))}o(0);function l(e){return[e[0],e[1],e[2]]}function d(e){return t=>function(e,t){const i=o("float"===t?2:0);return`rgb(${l(e.getComponents("rgb",t)).map((e=>i(e))).join(", ")})`}(t,e)}function h(e){return t=>function(e,t){const i=o(2),n=o("float"===t?2:0);return`rgba(${e.getComponents("rgb",t).map(((e,t)=>(3===t?i:n)(e))).join(", ")})`}(t,e)}function u(e){return t=>function(e,t){const i=o("float"===t?2:0),n=["r","g","b"];return`{${l(e.getComponents("rgb",t)).map(((e,t)=>`${n[t]}: ${i(e)}`)).join(", ")}}`}(t,e)}function p(e){return t=>function(e,t){const i=o(2),n=o("float"===t?2:0),s=["r","g","b","a"];return`{${e.getComponents("rgb",t).map(((e,t)=>`${s[t]}: ${(3===t?i:n)(e)}`)).join(", ")}}`}(t,e)}["int","float"].reduce(((e,t)=>[...e,{format:{alpha:!1,mode:"rgb",notation:"func",type:t},stringifier:d(t)},{format:{alpha:!0,mode:"rgb",notation:"func",type:t},stringifier:h(t)},{format:{alpha:!1,mode:"rgb",notation:"object",type:t},stringifier:u(t)},{format:{alpha:!0,mode:"rgb",notation:"object",type:t},stringifier:p(t)}]),[]);const c=i("tmp");class v{constructor(e,t){this.params_=t.params,this.value_=t.value,this.value_.rawValue.id=this.value_.rawValue.src,this.extensions_=this.params_.extensions||".jpg, .jpeg, .png, .webp, .avif",this.element=this.createElement_(e),t.viewProps.bindClassModifiers(this.element),this.head_=this.createHead_(e),this.element.appendChild(this.head_),this.monitor_=this.createMonitor_(e),this.head_.appendChild(this.monitor_),this.container_=this.createContainer_(e),this.element.appendChild(this.container_),this.input=this.createInput_(e),this.container_.appendChild(this.input),this.label_=this.createLabel_(e),this.container_.appendChild(this.label_),this.image_=this.createImage_(),this.container_.appendChild(this.image_),this.bindAll_(),this.setupEventListeners_(),this.refresh_(),t.viewProps.handleDispose((()=>{this.removeEventListeners_()}))}refresh_(){this.image_.setAttribute("src",this.value_.rawValue.src),this.value_.rawValue.src?(this.image_.style.opacity="1",this.label_.style.opacity="0"):this.label_.style.opacity="1",this.monitor_.innerHTML=this.value_.rawValue.id,this.value_.rawValue.id&&this.params_.showMonitor&&(this.head_.style.display="flex")}createElement_(e){const t=e.createElement("div");return t.classList.add(c()),t.style.position="relative",t.style.height=`${this.params_.height||100}px`,t}createContainer_(e){const t=e.createElement("div");return t.classList.add(c("container")),t.style.height=`${this.params_.height||100}px`,t}createHead_(e){const t=e.createElement("div");return t.classList.add(c("head")),this.value_.rawValue.id&&this.params_.showMonitor&&(t.style.display="flex"),t}createMonitor_(e){const t=e.createElement("div");return t.classList.add(c("monitor")),t.innerHTML=this.value_.rawValue.id,t}createInput_(e){const t=e.createElement("input");return t.classList.add(c("input")),t.setAttribute("id","image"),t.setAttribute("type","file"),t.setAttribute("accept",this.extensions_),t}createLabel_(e){const t=e.createElement("label");return t.setAttribute("for","image"),t.classList.add(c("label")),t.innerHTML="<span>Import image</span>",t}createImage_(){const e=new Image;return e.style.position="absolute",e.style.pointerEvents="none",e.style.left="0",e.style.top="0",e.style.width="100%",e.style.height="100%",e.style.objectFit=this.params_.objectFit||"cover",e}bindAll_(){this.valueChangedHandler_=this.valueChangedHandler_.bind(this),this.dragenterHandler_=this.dragenterHandler_.bind(this),this.dragleaveHandler_=this.dragleaveHandler_.bind(this),this.mouseenterHandler_=this.mouseenterHandler_.bind(this),this.mouseleaveHandler_=this.mouseleaveHandler_.bind(this)}setupEventListeners_(){this.value_.emitter.on("change",this.valueChangedHandler_),this.input.addEventListener("dragenter",this.dragenterHandler_),this.input.addEventListener("dragleave",this.dragleaveHandler_),this.input.addEventListener("mouseenter",this.mouseenterHandler_),this.input.addEventListener("mouseleave",this.mouseleaveHandler_)}removeEventListeners_(){this.value_.emitter.off("change",this.valueChangedHandler_.bind(this)),this.input.removeEventListener("dragenter",this.dragenterHandler_),this.input.removeEventListener("dragleave",this.dragleaveHandler_),this.input.removeEventListener("mouseenter",this.mouseenterHandler_),this.input.removeEventListener("mouseleave",this.mouseleaveHandler_)}valueChangedHandler_(){this.refresh_()}dragenterHandler_(e){e.dataTransfer&&e.dataTransfer.items[0]&&e.dataTransfer.items[0].type.includes("image")&&(this.image_.style.opacity="0",this.label_.style.opacity="1")}dragleaveHandler_(){this.value_.rawValue.src&&(this.image_.style.opacity="1",this.label_.style.opacity="0")}mouseenterHandler_(){this.container_.style.opacity="0.5"}mouseleaveHandler_(){this.container_.style.opacity="1"}}class m{constructor(e,t){this.value=t.value,this.params=t.params,this.viewProps=t.viewProps,this.viewProps.handleDispose((()=>{this.removeEventListeners_()})),this.view=new v(e,{value:this.value,viewProps:this.viewProps,params:this.params}),this.bindAll_(),this.setupEventListeners_()}bindAll_(){this.inputHandler_=this.inputHandler_.bind(this)}setupEventListeners_(){this.view.input.addEventListener("input",this.inputHandler_)}removeEventListeners_(){this.view.input.removeEventListener("input",this.inputHandler_)}inputHandler_(){const e=this.view.input.files?this.view.input.files[0]:null;if(!e)return;const t=new Image;t.src=URL.createObjectURL(e),t.id=e.name;const i=()=>{t.removeEventListener("load",i),this.value.rawValue=t};t.addEventListener("load",i)}}const _={id:"image-input",type:"input",css:".tp-tmpv{display:flex;flex-direction:column;overflow:hidden;position:relative;background-color:var(--bs-bg)}.tp-tmpv.tp-v-disabled{opacity:.5}.tp-tmpv_label{display:flex;justify-content:center;align-items:center;position:absolute;left:0;top:0;bottom:0;right:0;margin:auto;text-align:center;width:100%;pointer-events:none;color:var(--in-fg);font-size:.9em;line-height:.9;opacity:.5}.tp-tmpv_container{position:relative;background-color:var(--in-bg);border-radius:var(--elm-br);overflow:hidden}.tp-tmpv_head{display:none;align-items:center;width:100%;height:2em;margin-bottom:4px;background-color:var(--in-bg-a);border-radius:var(--elm-br);white-space:nowrap}.tp-tmpv_monitor{margin-top:1px;font-size:.9em;line-height:.9;opacity:.5;padding-left:4px;color:var(--in-fg)}.tp-tmpv_input{position:absolute;left:0;top:0;width:100%;height:100%;opacity:0;padding:0;cursor:pointer}.tp-tmpv input::-webkit-file-upload-button{display:none}",accept(e,t){if(!e)return null;if(!(e instanceof HTMLImageElement))return null;const i=r(t,{extensions:a.optional.string,objectFit:a.optional.string,height:a.optional.number,showMonitor:a.optional.boolean,label:a.required.string,view:a.required.constant("image")});return i?{initialValue:e,params:i}:null},binding:{reader:e=>e=>e instanceof HTMLImageElement?e:new Image,writer:e=>(e,t)=>{e.write(t)}},controller:e=>new m(e.document,{value:e.value,viewProps:e.viewProps,params:e.params})},g=i("tmp");class b{constructor(e,t){this.params_=t.params,this.value_=t.value,this.value_.rawValue.id=this.value_.rawValue.src,this.extensions_=this.params_.extensions||".mp4, .mov, .mpeg, .ogg, .webm, .mkv, .avi",this.element=this.createElement_(e),t.viewProps.bindClassModifiers(this.element),this.head_=this.createHead_(e),this.element.appendChild(this.head_),this.monitor_=this.createMonitor_(e),this.head_.appendChild(this.monitor_),this.container_=this.createContainer_(e),this.element.appendChild(this.container_),this.input=this.createInput_(e),this.container_.appendChild(this.input),this.label_=this.createLabel_(e),this.container_.appendChild(this.label_),this.video_=this.createVideo_(e),this.container_.appendChild(this.video_),this.bindAll_(),this.setupEventListeners_(),this.refresh_(),t.viewProps.handleDispose((()=>{this.removeEventListeners_()}))}refresh_(){this.video_.setAttribute("src",this.value_.rawValue.src),this.value_.rawValue.src?(this.video_.style.opacity="1",this.label_.style.opacity="0"):this.label_.style.opacity="1",this.monitor_.innerHTML=this.value_.rawValue.id,this.value_.rawValue.id&&this.params_.showMonitor&&(this.head_.style.display="flex")}createElement_(e){const t=e.createElement("div");return t.classList.add(g()),t.style.position="relative",this.params_.height&&(t.style.height=`${this.params_.height}px`),t}createContainer_(e){const t=e.createElement("div");return t.classList.add(g("container")),this.params_.height&&(t.style.height=`${this.params_.height}px`),t}createHead_(e){const t=e.createElement("div");return t.classList.add(g("head")),this.value_.rawValue.id&&this.params_.showMonitor&&(t.style.display="flex"),t}createMonitor_(e){const t=e.createElement("div");return t.classList.add(g("monitor")),t.innerHTML=this.value_.rawValue.id,t}createInput_(e){const t=e.createElement("input");return t.classList.add(g("input")),t.setAttribute("id","image"),t.setAttribute("type","file"),t.setAttribute("accept",this.extensions_),t}createLabel_(e){const t=e.createElement("label");return t.setAttribute("for","image"),t.classList.add(g("label")),t.innerHTML="<span>Import video</span>",t}createVideo_(e){const t=e.createElement("video");return t.setAttribute("muted","true"),t.setAttribute("playsinline","true"),t.setAttribute("autoplay","true"),t.setAttribute("loop","true"),t.style.opacity="0",t.style.position="absolute",t.style.pointerEvents="none",t.style.left="0",t.style.top="0",t.style.width="100%",t.style.height="100%",t.style.objectFit="cover",t.style.objectFit=this.params_.objectFit||"cover",t}bindAll_(){this.valueChangedHandler_=this.valueChangedHandler_.bind(this),this.dragenterHandler_=this.dragenterHandler_.bind(this),this.dragleaveHandler_=this.dragleaveHandler_.bind(this),this.mouseenterHandler_=this.mouseenterHandler_.bind(this),this.mouseleaveHandler_=this.mouseleaveHandler_.bind(this)}setupEventListeners_(){this.value_.emitter.on("change",this.valueChangedHandler_),this.input.addEventListener("dragenter",this.dragenterHandler_),this.input.addEventListener("dragleave",this.dragleaveHandler_),this.input.addEventListener("mouseenter",this.mouseenterHandler_),this.input.addEventListener("mouseleave",this.mouseleaveHandler_)}removeEventListeners_(){this.value_.emitter.off("change",this.valueChangedHandler_.bind(this)),this.input.removeEventListener("dragenter",this.dragenterHandler_),this.input.removeEventListener("dragleave",this.dragleaveHandler_),this.input.removeEventListener("mouseenter",this.mouseenterHandler_),this.input.removeEventListener("mouseleave",this.mouseleaveHandler_)}valueChangedHandler_(){this.refresh_()}dragenterHandler_(e){e.dataTransfer&&e.dataTransfer.items[0]&&e.dataTransfer.items[0].type.includes("video")&&(this.video_.style.opacity="0",this.label_.style.opacity="1")}dragleaveHandler_(){this.value_.rawValue.src&&(this.video_.style.opacity="1",this.label_.style.opacity="0")}mouseenterHandler_(){this.container_.style.opacity="0.5"}mouseleaveHandler_(){this.container_.style.opacity="1"}}class f{constructor(e,t){this.value=t.value,this.params=t.params,this.viewProps=t.viewProps,this.viewProps.handleDispose((()=>{this.removeEventListeners_()})),this.view=new b(e,{value:this.value,viewProps:this.viewProps,params:this.params}),this.bindAll_(),this.setupEventListeners_()}bindAll_(){this.inputHandler_=this.inputHandler_.bind(this)}setupEventListeners_(){this.view.input.addEventListener("input",this.inputHandler_)}removeEventListeners_(){this.view.input.removeEventListener("input",this.inputHandler_)}inputHandler_(){const e=this.view.input.files?this.view.input.files[0]:null;if(!e)return;const t=document.createElement("video");t.src=URL.createObjectURL(e),t.id=e.name;const i=()=>{t.removeEventListener("canplay",i),this.value.rawValue=t};t.addEventListener("canplay",i)}}const y=[_,{id:"video-input",type:"input",css:".tp-tmpv{display:flex;flex-direction:column;overflow:hidden;position:relative;background-color:var(--bs-bg)}.tp-tmpv.tp-v-disabled{opacity:.5}.tp-tmpv_label{display:flex;justify-content:center;align-items:center;position:absolute;left:0;top:0;bottom:0;right:0;margin:auto;text-align:center;width:100%;pointer-events:none;color:var(--in-fg);font-size:.9em;line-height:.9;opacity:.5}.tp-tmpv_container{position:relative;background-color:var(--in-bg);border-radius:var(--elm-br);overflow:hidden}.tp-tmpv_head{display:none;align-items:center;width:100%;height:2em;margin-bottom:4px;background-color:var(--in-bg-a);border-radius:var(--elm-br);white-space:nowrap}.tp-tmpv_monitor{margin-top:1px;font-size:.9em;line-height:.9;opacity:.5;padding-left:4px;color:var(--in-fg)}.tp-tmpv_input{position:absolute;left:0;top:0;width:100%;height:100%;opacity:0;padding:0;cursor:pointer}.tp-tmpv input::-webkit-file-upload-button{display:none}",accept(e,t){if(!e)return null;if(!(e instanceof HTMLVideoElement))return null;const i=r(t,{extensions:a.optional.string,objectFit:a.optional.string,height:a.optional.number,showMonitor:a.optional.boolean,label:a.required.string,view:a.required.constant("video")});return i?{initialValue:e,params:i}:null},binding:{reader:e=>e=>e instanceof HTMLVideoElement?e:document.createElement("video"),writer:e=>(e,t)=>{e.write(t)}},controller:e=>new f(e.document,{value:e.value,viewProps:e.viewProps,params:e.params})}];e.plugins=y,Object.defineProperty(e,"__esModule",{value:!0})}));
